<div class="dashboard-layout">
  <app-sidebar></app-sidebar>
  
  <div class="main-content">
    <app-header></app-header>
    
    <div class="page-content">
      <div class="page-header">
        <div>
          <h1><i class="fas fa-user-md"></i> Gestion des Médecins</h1>
          <p class="page-subtitle">Liste complète des médecins approuvés</p>
        </div>
        <button class="btn-add-new" routerLink="/admin">
          <i class="fas fa-user-plus"></i> Approuver Médecins
        </button>
      </div>

      <!-- Barre de recherche et filtres -->
      <div class="toolbar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input
            type="text"
            [(ngModel)]="searchTerm"
            (input)="searchMedecins()"
            placeholder="Rechercher un médecin...">
        </div>
        
        <select 
          class="filter-select"
          [(ngModel)]="filterSpecialite"
          (change)="filterBySpecialite()">
          <option value="">Toutes les spécialités</option>
          <option *ngFor="let spec of specialites" [value]="spec">{{spec}}</option>
        </select>

        <button class="btn-export">
          <i class="fas fa-download"></i> Exporter
        </button>
      </div>

      <!-- Statistiques par spécialité -->
      <div class="specialites-grid">
        <div *ngFor="let spec of specialites.slice(0, 6)" class="specialite-card">
          <i class="fas fa-stethoscope"></i>
          <div>
            <p class="spec-name">{{spec}}</p>
            <p class="spec-count">{{getSpecialiteCount(spec)}} médecins</p>
          </div>
        </div>
      </div>

      <!-- Loading -->
      <div *ngIf="loading" class="loading-container">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Chargement des médecins...</p>
      </div>

      <!-- Cards Grid -->
      <div *ngIf="!loading" class="medecins-grid">
        <div *ngFor="let medecin of filteredMedecins" class="medecin-card">
          <div class="card-header">
            <img [src]="medecin.photoBase64 || 'assets/default-avatar.png'" 
                 alt="Photo" 
                 class="medecin-photo">
            <span class="status-badge active">Actif</span>
          </div>

          <div class="card-body">
            <h3>Dr. {{medecin.prenom}} {{medecin.nom}}</h3>
            <p class="specialite">
              <i class="fas fa-stethoscope"></i> {{medecin.specialite}}
            </p>
            
            <div class="info-list">
              <div class="info-row">
                <i class="fas fa-id-card"></i>
                <span>RPPS: {{medecin.rpps}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-envelope"></i>
                <span>{{medecin.email}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-phone"></i>
                <span>{{medecin.telephone}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-hospital"></i>
                <span>{{medecin.adresseHopital}}</span>
              </div>
            </div>
          </div>

          <div class="card-footer">
            <button class="btn-card blue" (click)="viewMedecin(medecin)">
              <i class="fas fa-eye"></i> Détails
            </button>
            <button class="btn-card green">
              <i class="fas fa-edit"></i> Modifier
            </button>
            <button class="btn-card red" (click)="deleteMedecin(medecin.id)">
              <i class="fas fa-trash"></i> Supprimer
            </button>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && filteredMedecins.length === 0" class="empty-state">
        <i class="fas fa-user-md"></i>
        <h3>Aucun médecin trouvé</h3>
        <p>Essayez de modifier vos critères de recherche</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal Detail -->
<div class="modal-overlay" *ngIf="selectedMedecin" (click)="closeMedecinDetail()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2><i class="fas fa-user-md"></i> Profil du Médecin</h2>
      <button class="btn-close" (click)="closeMedecinDetail()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="profile-section">
        <img [src]="selectedMedecin.photoBase64 || 'assets/default-avatar.png'" 
             alt="Photo" 
             class="profile-photo">
        <h3>Dr. {{selectedMedecin.prenom}} {{selectedMedecin.nom}}</h3>
        <p class="profile-specialite">{{selectedMedecin.specialite}}</p>
        <span class="badge badge-success">Médecin Approuvé</span>
      </div>

      <div class="details-grid">
        <div class="detail-group">
          <h4><i class="fas fa-info-circle"></i> Informations Professionnelles</h4>
          <div class="detail-item">
            <label>Numéro RPPS</label>
            <p>{{selectedMedecin.rpps}}</p>
          </div>
          <div class="detail-item">
            <label>Spécialité</label>
            <p>{{selectedMedecin.specialite}}</p>
          </div>
          <div class="detail-item">
            <label>Adresse Hôpital</label>
            <p>{{selectedMedecin.adresseHopital}}</p>
          </div>
        </div>

        <div class="detail-group">
          <h4><i class="fas fa-address-book"></i> Coordonnées</h4>
          <div class="detail-item">
            <label>Email</label>
            <p>{{selectedMedecin.email}}</p>
          </div>
          <div class="detail-item">
            <label>Téléphone</label>
            <p>{{selectedMedecin.telephone}}</p>
          </div>
          <div class="detail-item">
            <label>Date d'inscription</label>
            <p>{{formatDate(selectedMedecin.dateInscription)}}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeMedecinDetail()">Fermer</button>
      <button class="btn-primary">
        <i class="fas fa-edit"></i> Modifier
      </button>
    </div>
  </div>
</div>